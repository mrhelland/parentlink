/**
 * @module     local_parentlink/studentsearch
 * @copyright  2025
 * @license    http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later
 *
 * Enables AJAX-powered student searching for the Parent Link Manager form.
 */
define("local_parentlink/studentsearch",["jquery","core/notification"],(function($,Notification){return{init:function(){const searchField=$("#id_studentsearch"),listbox=$("#id_studentids");M.cfg.developerdebug&&console.log('local_parentlink/studentsearch loaded (run "grunt amd" if stale)'),searchField.on("keydown",(function(e){"Enter"!==e.key&&13!==e.which||(e.preventDefault(),function(){const query=searchField.val().trim();if(!query.length)return;searchField.val("");const existingOptions=listbox.find("option").clone(!0),loadingOption=$("<option>",{text:"Loading...",disabled:!0,selected:!0});listbox.empty().append(loadingOption),$.ajax({url:M.cfg.wwwroot+"/local/parentlink/ajax.php?sesskey="+M.cfg.sesskey,method:"GET",data:{term:query},dataType:"json",success:function(results){if(listbox.empty(),existingOptions.each((function(){listbox.append($(this))})),!Array.isArray(results))return;const existingIds=new Set(listbox.find("option").map((function(){return $(this).val()})).get());0!==results.length?(results.forEach((function(item){existingIds.has(String(item.id))||listbox.append($("<option>",{value:item.id,text:item.name}))})),listbox.trigger("change")):Notification.addNotification({message:"No students found matching your search.",type:"warning"})},error:function(){Notification.addNotification({message:"An error occurred while searching.",type:"error"})}})}())}))}}}));

//# sourceMappingURL=studentsearch.min.js.map